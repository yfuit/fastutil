<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<script type="text/javascript" src="../static/easyui/jquery.min.js" ></script>
		<script type="text/javascript" src="../static/remote.js" ></script>
		<script type="text/javascript" src="../static/layui/layui.all.js" ></script>
		<link rel="stylesheet" href="../static/layui/css/layui.css"  media="all">
	</head>
	<body>

		<form class="layui-form layui-form-pane" action="" style="margin:10px;">
			<div class="layui-form-item">
				<div class="layui-form-item layui-form-text layui-col-xs3">
					<label class="layui-form-label">转换乱码字符 <button onclick="transferLanguage();return false;" class="layui-btn layui-btn-sm" style="float: right;margin-top: -5px;" >转&nbsp;&nbsp;码</button> </label>
					<div class="layui-input-block">
						<textarea id="contval" placeholder="请输入转换的文本内容" class="layui-textarea"></textarea>
					</div>
				</div>
			</div>
		</form>
		<div class="layui-hide" >
			<table class="layui-table" id="tablelanguage" >
				<colgroup><col width="150"><col></colgroup>
				<thead><tr><th>编码格式</th><th>编码内容</th></tr></thead>
				<tbody id="tableContent"></tbody>
			</table>
		</div>

	</body>
	<script>
		var scripT =  `
			String[] charts = ["GBK","UTF-8","ISO-8859-1"];
			List list = new ArrayList<Map>();
			for(String chart : charts){
				try {
					Map map = new HashMap<String,String>();
					map.put("chart",chart);
					map.put("val",new String(tmp.getBytes(chart)));
					list.add(map);
				} catch (UnsupportedEncodingException e) {
					e.printStackTrace();
				}
			}
			println("com.CTX.result:"+list)
			com.CTX.result = list;
		`;

		function transferLanguage(){
			let tmp =  "String tmp =  URLDecoder.decode(\""+encodeURIComponent($('#contval').val())+"\",\"UTF-8\");";
		    $.get("http://localhost:8083/grun",{gstr:tmp + scripT},function(data){
		        $('#tableContent').html('');
		        for(var i in data){
					$('#tableContent').append("<tr><td>"+data[i]['chart'] +"</td><td>"+data[i]['val']+"</td></tr>")
				}
                layer.open({
                    type: 1,
					title:'转码结果',
                    skin: 'layui-layer-rim', //加上边框
                    area: ['630px', '360px'], //宽高
                    content:$('#tablelanguage').parent().html()
                });
		    })
		}
	</script>
		
</html>
